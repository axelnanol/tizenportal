/**
 * Audiobookshelf Bundle Styles for TizenPortal
 * 
 * TV-optimized styles for Audiobookshelf.
 * Designed to work with Tailwind CSS v4 and Nuxt.
 */

/* ==========================================================================
   CSS VARIABLE POLYFILL FOR CHROME 47
   Chrome 47 doesn't support CSS custom properties (var()).
   Tailwind CSS v4 uses calc(var(--spacing)*N) for all utility classes.
   We must provide explicit fallback values.
   --spacing: 0.25rem = 4px (at 16px base font-size)
   ========================================================================== */

/* Image constraints - CRITICAL for Chrome 47 */
img {
  max-width: 100% !important;
  height: auto !important;
}

/* Logo sizing (appbar) - w-8 h-8, sm:w-10 sm:h-10 */
#appbar img,
.nuxt-link-active img {
  width: 40px !important;
  min-width: 40px !important;
  height: 40px !important;
  max-width: 40px !important;
}

/* Width utilities that use var(--spacing) */
.w-8 { width: 32px !important; }
.w-10 { width: 40px !important; }
.w-12 { width: 48px !important; }
.w-16 { width: 64px !important; }
.w-full { width: 100% !important; }

/* Height utilities */
.h-8 { height: 32px !important; }
.h-10 { height: 40px !important; }
.h-12 { height: 48px !important; }
.h-16 { height: 64px !important; }
.h-full { height: 100% !important; }

/* Min/max width */
.min-w-8 { min-width: 32px !important; }
.min-w-10 { min-width: 40px !important; }
.max-w-full { max-width: 100% !important; }

/* Spacing/margins */
.mr-2 { margin-right: 8px !important; }
.mr-4 { margin-right: 16px !important; }
.mr-6 { margin-right: 24px !important; }
.mx-2 { margin-left: 8px !important; margin-right: 8px !important; }
.mx-2e { margin-left: 0.5em !important; margin-right: 0.5em !important; }

/* Padding */
.p-2 { padding: 8px !important; }
.p-4 { padding: 16px !important; }
.px-2 { padding-left: 8px !important; padding-right: 8px !important; }
.px-6 { padding-left: 24px !important; padding-right: 24px !important; }
.py-1 { padding-top: 4px !important; padding-bottom: 4px !important; }
.pt-6e { padding-top: 1.5em !important; }

/* Appbar height - h-16 = 64px */
.w-full.h-16.bg-primary {
  height: 64px !important;
}

/* Book card images - object-fill within constrained parent */
[cy-id="coverImage"],
.object-fill {
  width: 100% !important;
  height: 100% !important;
  object-fit: fill !important;
}

/* ==========================================================================
   BOOKSHELF ROW LAYOUT - HORIZONTAL SCROLLING
   Book cards must display horizontally with proper gaps for spatial navigation.
   Chrome 47 needs explicit flexbox properties.
   ========================================================================== */

/* Bookshelf row container - horizontal scroll */
.bookshelfRow,
.categorizedBookshelfRow {
  display: block !important;
  overflow-x: auto !important;
  overflow-y: hidden !important;
  white-space: nowrap !important;
  -webkit-overflow-scrolling: touch !important;
  padding-bottom: 40px !important; /* Space for card labels */
}

/* Inner wrapper divs */
.categorizedBookshelfRow > div,
.bookshelfRow > div {
  display: block !important;
  width: 100% !important;
}

/* The flex container that holds cards - CRITICAL for horizontal layout */
.categorizedBookshelfRow .flex.items-center,
.bookshelfRow .flex.items-center,
.categorizedBookshelfRow > div > div > .flex,
.bookshelfRow > div > div > .flex {
  display: -webkit-box !important;
  display: -webkit-flex !important;
  display: flex !important;
  -webkit-box-orient: horizontal !important;
  -webkit-box-direction: normal !important;
  -webkit-flex-direction: row !important;
  flex-direction: row !important;
  -webkit-flex-wrap: nowrap !important;
  flex-wrap: nowrap !important;
  -webkit-box-align: start !important;
  -webkit-align-items: flex-start !important;
  align-items: flex-start !important;
  /* Allow content to extend beyond container */
  width: max-content !important;
  min-width: 100% !important;
}

/* Book card container - MUST have gaps for spatial navigation */
[id^="book-card-"],
[id^="series-card-"] {
  display: inline-block !important;
  vertical-align: top !important;
  /* Remove absolute positioning - it breaks flex flow */
  position: relative !important;
  /* CRITICAL: Gaps between cards for spatial navigation */
  margin: 16px !important;
  /* Flex item properties */
  -webkit-flex-shrink: 0 !important;
  flex-shrink: 0 !important;
}

/* Book cards - fixed width */
[id^="book-card-"] {
  width: 192px !important;
  min-width: 192px !important;
  max-width: 192px !important;
}

/* Series cards - wider */
[id^="series-card-"] {
  width: 384px !important;
  min-width: 384px !important;
  max-width: 384px !important;
}

/* Cover area container */
[id^="cover-area-"] {
  width: 192px !important;
  height: 192px !important;
  overflow: hidden !important;
}

/* Ensure images inside cover area respect bounds */
[id^="cover-area-"] img {
  width: 100% !important;
  height: 100% !important;
  max-width: 100% !important;
  max-height: 100% !important;
  object-fit: fill !important;
}

/* ==========================================================================
   VUE/NUXT HIDDEN ELEMENTS
   Force-hide elements that Vue renders with display:none inline style.
   Chrome 47 may have issues with Vue's conditional rendering.
   ========================================================================== */

/* Ensure inline display:none is respected */
[style*="display: none"],
[style*="display:none"] {
  display: none !important;
  visibility: hidden !important;
}

/* Hidden menus and dropdowns */
.librariesDropdownMenu[style*="display: none"],
.globalSearchMenu[style*="display: none"],
.globalTaskRunningMenu[style*="display: none"],
[role="menu"][style*="display: none"] {
  display: none !important;
}

/* Modal hidden state */
.modal.hidden,
.modal[style*="display: none"],
.modal.opacity-0 {
  display: none !important;
  visibility: hidden !important;
}

/* Cover background when not needed */
[cy-id="coverBg"][style*="display: none"] {
  display: none !important;
}

/* Title placeholder when image is ready */
[cy-id="titleImageNotReady"][style*="display: none"] {
  display: none !important;
}

/* Selection mode toolbar (when no items selected) */
.absolute[style*="display: none"] {
  display: none !important;
}

/* ==========================================================================
   VIEWPORT LOCK
   Force 1920px width to disable Tailwind responsive breakpoints.
   ABS uses sm:, md:, lg: breakpoints that we want to bypass.
   ========================================================================== */

html {
  min-width: 1920px !important;
  max-width: 1920px !important;
  overflow-x: hidden !important;
}

body {
  min-width: 1920px !important;
  overflow-x: hidden !important;
}

/* ==========================================================================
   FOCUS INDICATORS
   Strong, visible focus styling for TV remote navigation.
   Using ABS accent color (#1ad691) for consistency.
   ========================================================================== */

/* Siderail navigation links */
[role="toolbar"][aria-orientation="vertical"] a:focus,
#siderail-buttons-container a:focus {
  outline: 4px solid #1ad691 !important;
  outline-offset: -4px !important;
  background-color: rgba(26, 214, 145, 0.15) !important;
}

/* Appbar elements */
#appbar a:focus,
#appbar button:focus {
  outline: 3px solid #1ad691 !important;
  outline-offset: 2px !important;
}

/* Book cards (divs with id="book-card-N") */
[id^="book-card-"]:focus {
  outline: 4px solid #1ad691 !important;
  outline-offset: 4px !important;
  z-index: 100 !important;
}

/* Scale up focused book cards */
[id^="book-card-"]:focus [id^="cover-area-"] {
  transform: scale(1.05) !important;
  transition: transform 0.15s ease-out !important;
}

/* Legacy bookshelf link focus (if any links exist) */
.bookshelfRow a:focus,
.categorizedBookshelfRow a:focus,
#bookshelf a:focus {
  outline: 4px solid #1ad691 !important;
  outline-offset: 4px !important;
  z-index: 100 !important;
  position: relative !important;
}

/* Scale up focused book covers slightly */
.bookshelfRow a:focus > div,
.categorizedBookshelfRow a:focus > div {
  transform: scale(1.05) !important;
  transition: transform 0.15s ease-out !important;
}

/* Dropdown menu items */
[role="menuitem"]:focus,
[role="menu"] li:focus {
  outline: 3px solid #1ad691 !important;
  outline-offset: -3px !important;
  background-color: rgba(26, 214, 145, 0.2) !important;
}

/* Generic buttons */
button:focus:not([aria-hidden="true"]) {
  outline: 3px solid #1ad691 !important;
  outline-offset: 2px !important;
}

/* Form inputs */
input:focus,
select:focus,
textarea:focus {
  outline: 3px solid #1ad691 !important;
  border-color: #1ad691 !important;
}

/* Links in content areas */
a[href]:focus:not(#appbar a):not([role="toolbar"] a):not(.bookshelfRow a):not(.categorizedBookshelfRow a) {
  outline: 2px solid #1ad691 !important;
  outline-offset: 2px !important;
}

/* ==========================================================================
   SIDERAIL ADJUSTMENTS
   Ensure siderail is always visible and properly sized for TV.
   ========================================================================== */

/* Keep siderail visible */
[role="toolbar"][aria-orientation="vertical"] {
  display: block !important;
  opacity: 1 !important;
  visibility: visible !important;
  pointer-events: auto !important;
}

/* Larger touch targets for siderail links */
#siderail-buttons-container a {
  min-height: 80px !important;
}

/* ==========================================================================
   BOOKSHELF ADJUSTMENTS
   Make book cards more TV-friendly.
   ========================================================================== */

/* Ensure bookshelf rows are scrollable horizontally */
.categorizedBookshelfRow {
  overflow-x: auto !important;
  scroll-behavior: smooth !important;
}

/* Remove hover-only effects that don't work on TV */
.bookshelfRow a,
.categorizedBookshelfRow a {
  cursor: pointer !important;
}

/* ==========================================================================
   HIDE MOBILE ELEMENTS
   Hide UI elements designed for small screens.
   ========================================================================== */

/* Mobile-specific elements (these shouldn't show at 1920px anyway) */
.mobile-menu,
.mobile-nav,
[class*="mobile-only"] {
  display: none !important;
}

/* ==========================================================================
   MODAL ADJUSTMENTS
   Ensure modals are navigable with D-pad.
   ========================================================================== */

/* Modal close button focus */
.modal button:focus,
[role="dialog"] button:focus {
  outline: 3px solid #1ad691 !important;
  outline-offset: 2px !important;
}

/* Modal should be on top */
.modal,
[role="dialog"] {
  z-index: 9000 !important;
}

/* ==========================================================================
   SCROLLBAR STYLING
   TV-friendly scrollbars.
   ========================================================================== */

::-webkit-scrollbar {
  width: 12px !important;
  height: 12px !important;
}

::-webkit-scrollbar-track {
  background: rgba(35, 35, 35, 0.8) !important;
}

::-webkit-scrollbar-thumb {
  background: #1ad691 !important;
  border-radius: 6px !important;
}

::-webkit-scrollbar-thumb:hover {
  background: #15b578 !important;
}

/* ==========================================================================
   TEXT SELECTION
   Disable text selection (not useful on TV).
   ========================================================================== */

* {
  -webkit-user-select: none !important;
  user-select: none !important;
}

/* Allow selection in inputs */
input,
textarea,
[contenteditable="true"] {
  -webkit-user-select: text !important;
  user-select: text !important;
}

/* ==========================================================================
   PLAYER BAR (placeholder for future)
   Player styles will be added when we analyze the player DOM.
   ========================================================================== */

/* Player container focus */
#mediaPlayerContainer button:focus {
  outline: 3px solid #1ad691 !important;
  outline-offset: 2px !important;
}
